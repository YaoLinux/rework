# Depends on: qt-base mesa 

description="A cross-platform application and UI framework, QtDeclarative files"
url="http://qt-project.org/"
packager="tnut <tnut@nutyx.org>"
contributors="Pierre B"

name=qt-declarative 
version=5.9.1
release=1
alias=(qtdeclarative)
_name="${name/-/}-opensource-src"

source=(https://download.qt.io/official_releases/qt/5.9/$version/submodules/${_name}-${version}.tar.xz)

build() {
cd ${_name}-${version}
qmake
make
make INSTALL_ROOT=$PKG install

mkdir -p $PKG/usr/bin
#for i in $PKG/usr/bin/qt/*; do 
#    ln -sv /usr/bin/qt/$(basename $i) $PKG/usr/bin/$(basename $i)-qt
#done
for file in moc uic rcc qmake lconvert lrelease lupdate; do
  ln -sfrvn /usr/bin/qt/$file $PKG/usr/bin/$file-qt
done

# Drop QMAKE_PRL_BUILD_DIR because reference the build dir
  find "$PKG/usr/lib" -type f -name '*.prl' \
       -exec sed -i -e '/^QMAKE_PRL_BUILD_DIR/d' {} \;
}
